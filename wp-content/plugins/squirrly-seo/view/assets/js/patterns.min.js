var SQ_DEBUG,$jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var e=a.length,d=0;d<e;d++){var f=a[d];if(b.call(c,f,d,a))return{i:d,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,b,c,e){if(b){c=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var d=a[e];d in c||(c[d]={});c=c[d]}a=a[a.length-1];e=c[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");"undefined"===typeof SQ_DEBUG&&(SQ_DEBUG=!1);var $sq_patterns=[];
(function(a){a.fn.sq_patterns=function(){var b=this,c=!1,e=0,d=a('<div class="sq_pattern_icon" title="Click to edit/add more patterns"></div>'),f=a('<div class="sq_pattern_list sq-col-sm-12 sq-mx-0 sq-px-0" style="display: none"><ul><li class="sq_nostyle">Click to insert a pattern:</li></ul></div>');0<b.find("input[type=text]").length?c=b.find("input[type=text]"):0<b.find("textarea").length&&(c=b.find("textarea"));b.data("patternid")&&(e=b.data("patternid"));d.off("click");f.find("li").off("click");
b.init=function(){if(!b.find(".sq_pattern_list").length){b.append(f);var c=b.parents(".sq_blocksnippet:last");"undefined"===typeof $sq_patterns[e]&&($sq_patterns[e]=b.sq_getPatterns(c.find("input[name=sq_post_id]").val(),c.find("input[name=sq_term_id]").val(),c.find("input[name=sq_taxonomy]").val(),c.find("input[name=sq_post_type]").val()));$sq_patterns[e].done(function(c){if("undefined"!==typeof c){if(SQ_DEBUG&&console.log(c),"undefined"!==typeof c.json){a.sq_patterns_list=a.parseJSON(c.json);for(var d in a.sq_patterns_list)("{{page}}"===
d||""!==a.sq_patterns_list[d]&&null!==a.sq_patterns_list[d])&&b.find(".sq_pattern_list").find("ul").append('<li data-pattern="'+d+'" data-value="'+a.sq_patterns_list[d]+'" title="'+a.sq_patterns_list[d]+'">'+d+"</li>");b.selectPattern()}}else SQ_DEBUG&&console.log("no data received")})}};b.listenIcon=function(){b.find(".sq_pattern_icon").length||(b.append(d),d.on("click",function(){f.toggle();f.is(":visible")?(d.addClass("sq_opened"),b.selectPattern(),c.off("change").on("change",function(){b.selectPattern()}),
f.find("li:not(.sq_nostyle)").off("click").on("click",function(){b.selectPattern(a(this).html())})):d.removeClass("sq_opened")}))};b.selectPattern=function(b){var d=[];if("undefined"!==typeof b){var e=c.val();e="{{sep}}"!==b&&-1!==e.indexOf(b)?e.replace(b,"").replace("  "," ").trim():e.split(" ").pop()!==b?(e+" "+b).trim():e.substring(0,e.lastIndexOf(b)).trim();c.val(e)}1<c.val().length&&(d=c.val().split(" "));f.find("li").each(function(){a(this).removeClass("sq_patterns_selected")});if(0<d.length)for(var g=
0;g<d.length;g++)d[g].match(/{{[a-z_]+}}/g)&&f.find("li").each(function(){d[g]===a(this).html()&&a(this).addClass("sq_patterns_selected")});a.fn.highlightWithinTextarea&&c.highlightWithinTextarea({highlight:/({{[^\}]+}})/g});a.fn.sq_checkMax&&c.sq_checkMax()};b.highlightListen=function(){c.highlightWithinTextarea({highlight:/({{[^\}]+}})/g});c.off("change").on("change",function(){a(this).highlightWithinTextarea({highlight:/({{[^\}]+}})/g})})};c&&(b.listenIcon(),b.highlightListen());return b};a.fn.sq_getPatterns=
function(b,c,e,d){var f=this;f.addClass("sq_minloading");return a.post(sqQuery.ajaxurl,{action:"sq_getpatterns",post_id:b,term_id:c,taxonomy:e,post_type:d,sq_nonce:sqQuery.nonce}).done(function(a){SQ_DEBUG&&console.log(a);f.removeClass("sq_minloading")}).fail(function(){SQ_DEBUG&&console.log("no data received");f.removeClass("sq_minloading")})};a(document).ready(function(){a(".sq_pattern_field").each(function(){a(this).sq_patterns().init()})})})(jQuery);
